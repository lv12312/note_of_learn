##2、MySQL基准化分析

主要是使用 `sysbench` 工具对MySQL进行基准化分析。

###2.1 基准化分析的目的
分析出系统的容量、应用的表现等，主要有这几个目的：

* 验证系统的假设，看看假设是否成立
* 重现系统的弱点
* 评估当前系统的性能
* 估测系统的最高负载，判断出系统的瓶颈
* 未来扩展的规划
* 测试应用应对环境变化的容忍性
* 测试不同的硬件，软件和操作系统配置
* 证明新加入的硬件有被正确的配置

###2.2 基准化评估的策略
有两种主要的benchmark的策略，将应用作为一个整体或者单独测试。可以称之为全栈(full-stack 和 单组件(single-component)基准测试。全栈测试的原因是：

* 关系的是整个应用的能力，应用的处理能力才是关键
* MySQL不总是应用的瓶颈，全栈压测能够反映这点
* 只有全栈压测才能体现出单个部件的能力表现

####2.2.1 评估目标

* 吞吐量
* 响应时间或者等待时间
* 并发
* 水平伸缩性 主要用于容量评估

###2.3 基准化评估的战术

开始讨论之前，先了解一下测试的误区：

* 使用真实数据的子集，而不是真实环境下数据的规模。
* 使用不正确的分布式数据。
* 使用不真实的分布式参数。
* 在单用户场景下测试多用户使用的应用。
* 在单服务器上测试分布式应用。
* 没有匹配上真实用户的行为。
* 循环的跑相同的查询。
* 没有正确的检查错误。
* 忽略系统没有预热，可能系统刚刚启动。
* 使用默认的系统配置。
* 测试过快，没有经历长时间的测试。

正确的测试过程：

* 设计和计划, 制定好需要测试的目标，参数等等
* 需要测试多久，一般情况下都是测试到系统稳定为止。
* 抓取系统的性能和状态数据
* 获取正确的结果，最终绘制成图表。


###2.4 基准化测试工具

全栈测试工具：

* Apache ab
* http_load
* JMeter 

单组件测试工具：

* mysqlslap : 能模拟系统负载。
* sql-bench
* Super Smark
* Percona TPCC-MySQL 工具
* sysbench